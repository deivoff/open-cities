{"version":3,"sources":["apollo/mutations/index.ts","apollo/querries/index.ts","apollo/index.ts","components/layout/index.tsx","components/modal/index.tsx","components/spiner/index.tsx","context/auth-context.ts","components/header/index.tsx","widgets/MainBanner/utils.ts","widgets/MainBanner/index.tsx","pages/Main.tsx","widgets/MapControllers/index.tsx","pages/Map.tsx","App.tsx","serviceWorker.ts","index.tsx","components/layout/page.module.sass","components/modal/modal.module.sass","widgets/MainBanner/MainBanner.module.sass","components/header/header.module.sass","components/spiner/spiner.module.sass","widgets/MapControllers/MapControllers.module.sass"],"names":["AUTH_GOOGLE","gql","CREATE_LAYER","GET_GOOGLE_REDIRECT_URL","GET_CITIES","GET_LAYERS","cache","InMemoryCache","httpLink","createHttpLink","uri","authLink","setContext","_","headers","token","localStorage","getItem","client","ApolloClient","link","concat","name","queryDeduplication","defaultOptions","watchQuery","fetchPolicy","Button","props","className","cn","css","button","type","GoogleButton","Page","children","Card","Wrapper","Map","Title","Body","Modal","overlayClassName","onClick","onRequestClose","onKeyPress","Spiner","spiner","AuthContext","React","createContext","user","login","logout","CitiesList","useQuery","data","citiesLoading","loading","citiesError","error","cities","s","map","url","zoom","center","key","to","pathname","state","Profile","photos","givenName","familyName","alt","src","length","Header","useState","isAuthModalOpen","setAuthModal","authLoading","setAuthLoading","useContext","apolloClient","useApolloClient","googleSignHandler","e","a","preventDefault","query","getGoogleOAuthRedirect","test","window","open","addEventListener","authHandler","bind","this","close","removeEventListener","code","mutate","mutation","variables","responseToken","authGoogle","header","logo","nav","isOpen","shouldCloseOnOverlayClick","getRandomInt","min","max","Math","random","toFixed","getRandomNormal","skew","u","v","num","sqrt","log","cos","PI","getRandomCircle","randomIntOrNormal","x","y","radius","DotCreate","duration","setCircle","useEffect","interval","setInterval","clearInterval","cx","cy","r","fill","stroke","strokeWidth","attributeType","attributeName","begin","dur","repeatCount","from","Banner","dots","banner","description","title","text","decorative","xmlns","viewBox","width","height","id","strokeLinecap","strokeMiterlimit","clipPath","d","vectorEffect","i","MainPage","setDots","activeDots","setActiveDots","Helmet","CreateLayerModal","city","isCreateLayerModalOpen","setCreateLayerModalOpen","useMutation","createLayer","add","initialValues","onSubmit","setSubmitting","render","htmlFor","placeholder","component","style","display","MapControllers","defaultCity","MapPage","cityName","TileLayer","attribution","Marker","position","Popup","App","authContext","setToken","setUser","savedToken","jwtDecode","email","setItem","removeItem","useAuth","Provider","value","exact","path","match","location","params","Boolean","hostname","setAppElement","ReactDOM","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","module","exports"],"mappings":"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","file":"static/js/main.80798b8f.chunk.js","sourcesContent":["import { gql } from \"apollo-boost\";\r\n\r\nexport const AUTH_GOOGLE = gql`\r\n  mutation AuthGoogle($code: String!){\r\n    authGoogle(code: $code) {\r\n      token\r\n    }\r\n  }\r\n`;\r\n\r\nexport const CREATE_LAYER = gql`\r\n  mutation CreateLayer($name: String!, $description: String!, $city: String!){\r\n    createLayer(layerInput: {\r\n      name: $name,\r\n      description: $description,\r\n      city: $city\r\n    }) {\r\n      _id\r\n      name\r\n      description\r\n    }\r\n  }\r\n`","import { gql } from \"apollo-boost\";\r\n\r\nexport const GET_GOOGLE_REDIRECT_URL = gql`\r\n  {\r\n    getGoogleOAuthRedirect {\r\n      url\r\n    }\r\n  }\r\n`;\r\n\r\nexport const GET_CITIES = gql`\r\n  {\r\n    cities {\r\n      name\r\n      url\r\n      center\r\n      zoom\r\n    }\r\n  }\r\n`;\r\n\r\nexport const GET_LAYERS = gql`\r\n  query GetLayers($city: String!) {\r\n    layers(city: $city) {\r\n      _id\r\n      name\r\n      description\r\n    }\r\n  }\r\n`","import { ApolloClient } from 'apollo-boost';\r\nimport { createHttpLink } from 'apollo-link-http';\r\nimport { setContext } from 'apollo-link-context';\r\nimport { InMemoryCache } from 'apollo-cache-inmemory';\r\nexport * from './mutations';\r\nexport * from './querries';\r\n\r\n// Instantiate required constructor fields\r\nconst cache = new InMemoryCache();\r\nconst httpLink = createHttpLink({\r\n  uri: 'http://localhost:7000/graphql',\r\n});\r\n\r\nconst authLink = setContext((_, { headers }) => {\r\n  // get the authentication token from local storage if it exists\r\n  const token = localStorage.getItem('token');\r\n  // return the headers to the context so httpLink can read them\r\n  return {\r\n    headers: {\r\n      ...headers,\r\n      'Authorization': token ? `Bearer ${token}` : \"\",\r\n    }\r\n  }\r\n});\r\n\r\nexport const client = new ApolloClient({\r\n  // Provide required constructor fields\r\n  cache: cache,\r\n  link: authLink.concat(httpLink),\r\n  // Provide some optional constructor fields\r\n  name: 'open-cities',\r\n  queryDeduplication: false,\r\n  defaultOptions: {\r\n    watchQuery: {\r\n      fetchPolicy: 'cache-and-network',\r\n    },\r\n  },\r\n});","/* eslint-disable jsx-a11y/heading-has-content */\r\nimport React from 'react';\r\nimport cn from 'classnames';\r\nimport css from './page.module.sass';\r\n\r\nexport const Button = (props: any) => {\r\n  return (\r\n    <button\r\n      className={cn(css.button, css['_success'])}\r\n      type='button'\r\n      {...props}\r\n    />\r\n  );\r\n};\r\n\r\nexport const GoogleButton = (props: any) => {\r\n  return (\r\n    <button\r\n      className={css['google-button']}\r\n      type='button'\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nexport const H1 = (props: any) => {\r\n  return <h1 className={cn(css['page__title'])} {...props} />;\r\n};\r\n\r\nexport const Page = ({ children }: any) => {\r\n  return <>{children}</>;\r\n};\r\n\r\nPage.Wrapper = function Wrapper(props: any) {\r\n  return <div className={cn(css['page__wrapper'])} {...props} />;\r\n};\r\n\r\nPage.Map = function Map(props: any) {\r\n  return(<div className={cn(css['page__map'])} {...props} />);\r\n}\r\n\r\nexport function Card(props: any) {\r\n  return <div className={cn(css['card'])} {...props} />;\r\n}\r\n\r\nCard.Title = function Title(props: any) {\r\n  return <div className={cn(css['card__title'])} {...props} />;\r\n};\r\n\r\nCard.Body = function Body(props: any) {\r\n  return <div className={cn(css['card__body'])} {...props} />;\r\n};\r\n","import ReactModal from 'react-modal';\r\nimport React from 'react';\r\nimport css from './modal.module.sass';\r\n\r\nexport const Modal = (props: ReactModal.Props & { children: React.ReactNode}) => (\r\n  <ReactModal\r\n    {...props}\r\n    className={css['modal-window']}\r\n    overlayClassName={css['modal-wrapper']}\r\n  >\r\n      <button\r\n        type='button'\r\n        className={css['modal-window__close']}\r\n        onClick={props.onRequestClose}\r\n        onKeyPress={props.onRequestClose}\r\n      >\r\n        <span />\r\n        <span />\r\n      </button>\r\n    {props.children}\r\n  </ReactModal>\r\n)\r\n\r\nModal.Title = function Title(props: any) {\r\n  return <h2 \r\n    {...props} \r\n    className={css['modal-window__title']}\r\n  />;\r\n}\r\nModal.Body = function Body(props: any) {\r\n  return <div\r\n    {...props} \r\n    className={css['modal-window__body']}\r\n  />;\r\n}","import React from 'react';\r\nimport css from './spiner.module.sass';\r\n\r\nexport const Spiner = () => <div className={css.spiner}><div className={css['lds-ellipsis']}><div /><div /><div /><div /></div></div>","import React, { useState, useEffect } from 'react';\r\nimport jwtDecode from 'jwt-decode';\r\n\r\nexport interface IAuthContext {\r\n  token: string | null;\r\n  user: IUser | null;\r\n  login: ILogin;\r\n  logout: () => void;\r\n}\r\n\r\nexport interface IUser {\r\n  id: string,\r\n  email: string,\r\n  name: {\r\n    givenName: string,\r\n    familyName: string,\r\n  }\r\n  photos: [{\r\n    url: string\r\n  }]\r\n}\r\nexport interface ILogin {\r\n  (\r\n    token: string,\r\n  ): void;\r\n}\r\n\r\nexport const AuthContext = React.createContext<IAuthContext>({\r\n  token: null,\r\n  user: null,\r\n  login: (token: string) => {},\r\n  logout: () => {}\r\n});\r\n\r\nexport const useAuth = (): IAuthContext => {\r\n  const [token, setToken] = useState<string | null>(null);\r\n  const [user, setUser] = useState<IUser| null>(null);\r\n\r\n  useEffect(() => {\r\n    const savedToken = localStorage.getItem('token')\r\n    if (savedToken) {\r\n      setToken(savedToken);\r\n      const { email, name, photos, id }: IUser = jwtDecode(savedToken);\r\n      setUser({email, name, photos, id});\r\n    }\r\n  }, [])\r\n\r\n  const login: ILogin = (token: string) => {\r\n    setToken(token);\r\n    localStorage.setItem('token', token);\r\n    const { email, name, photos, id }: IUser = jwtDecode(token);\r\n    setUser({email, name, photos, id});\r\n  }\r\n\r\n  const logout = () => {\r\n    setToken(null);\r\n    localStorage.removeItem('token');\r\n    setUser(null);\r\n  }\r\n\r\n  return {login, logout, token, user}\r\n}","/* eslint-disable jsx-a11y/anchor-is-valid */\r\nimport React, { useState, MouseEvent, useContext } from 'react';\r\nimport cn from 'classnames';\r\nimport { Link } from 'react-router-dom';\r\nimport { useApolloClient, useQuery } from '@apollo/react-hooks';\r\nimport { Button, GoogleButton } from '../layout';\r\nimport { GET_GOOGLE_REDIRECT_URL, AUTH_GOOGLE, GET_CITIES } from '../../apollo';\r\nimport { Modal } from '../modal';\r\nimport { Spiner } from '../spiner';\r\nimport { AuthContext, IAuthContext, IUser } from '../../context';\r\n\r\nimport s from './header.module.sass';\r\n// const ArrowMenu = require('../../assets/svg/ArrowMenu.svg');\r\n\r\ninterface City {\r\n  name: string;\r\n  url: string;\r\n  center: [number, number];\r\n  zoom: number;\r\n}\r\n\r\nconst CitiesList = () => {\r\n  const { data, loading: citiesLoading, error: citiesError} = useQuery(GET_CITIES);\r\n\r\n  if (citiesLoading) return null\r\n  if (citiesError) return null\r\n\r\n  const { cities } = data;\r\n\r\n  return (\r\n    <div className={cn(s['nav__dropdown'])}>\r\n      <ul className={cn(s['nav__list'])}>\r\n        {cities ? (cities as City[]).map(({ name, url, zoom, center }: any) => (\r\n              <li className={cn(s['nav__elem'])} key={name}>\r\n                <Link to={{\r\n                  pathname: `/cities/${url}`,\r\n                  state: { center, zoom, name }\r\n                }}>\r\n                  {name}\r\n                </Link>\r\n              </li>\r\n            ))\r\n          : null}\r\n      </ul>\r\n    </div>\r\n  )\r\n}\r\n\r\ninterface IProfile {\r\n  user: IUser;\r\n  logout: () => void;\r\n}\r\nconst Profile = ({user: { name, photos }, logout }: IProfile) => {\r\n  return(\r\n    <div className={s['nav__profile']}>\r\n      <div className={cn(s['nav__elem'], s['_dropdown'])}>\r\n        {name\r\n          ? `${name.givenName} ${name.familyName}`\r\n          : null}\r\n        <div className={cn(s['nav__dropdown'], s['_profile'])}>\r\n          <ul className={cn(s['nav__list'], s['_profile'])}>\r\n            <li className={s['nav__elem']}>\r\n              <Link to='/profile'>\r\n                Мой профиль\r\n              </Link>\r\n            </li>\r\n            <li className={s['nav__elem']}>\r\n              <Link to='/maps'>\r\n                Мои карты\r\n              </Link>\r\n            </li>\r\n            <li className={s['nav__elem']}>\r\n              <Link to='/researches'>\r\n                Мои исследования\r\n              </Link>\r\n            </li>\r\n            <li className={s['nav__elem']} onClick={logout}>\r\n                Выйти\r\n            </li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n      <div className={s['nav__photo']}>\r\n        <img\r\n          alt='User thimbnail'\r\n          src={\r\n            photos\r\n              ? photos[photos.length - 1].url\r\n                ? photos[photos.length - 1].url\r\n                : ''\r\n              : ''\r\n          }\r\n        />\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport const Header: React.SFC = () => {\r\n  const [isAuthModalOpen, setAuthModal] = useState(false);\r\n  const [authLoading, setAuthLoading] = useState(false);\r\n\r\n  const { token, user, login, logout } = useContext<IAuthContext>(AuthContext)\r\n  const apolloClient = useApolloClient();\r\n\r\n  const openModalHandler = () => {\r\n    setAuthModal(true);\r\n  }\r\n\r\n  const closeModalHandler = () => {\r\n    setAuthModal(false);\r\n  }\r\n\r\n  const googleSignHandler = async (e: MouseEvent) => {\r\n    e.preventDefault()\r\n    setAuthLoading(true);\r\n  \r\n    try {\r\n      const { data } = await apolloClient.query({ query: GET_GOOGLE_REDIRECT_URL })\r\n      const { url } = data.getGoogleOAuthRedirect;\r\n      const test = window.open(url, 'OAuth')!;\r\n      \r\n      window.addEventListener('message', authHandler.bind(test));\r\n    } catch (error) {\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  async function authHandler(this: Window, e: MessageEvent) {\r\n    // 'this' = children window \r\n    this.close();\r\n    window.removeEventListener('message', authHandler);\r\n    const code = e.data;\r\n\r\n    try {\r\n      const { data } = await apolloClient.mutate({ mutation: AUTH_GOOGLE, variables: { code } });\r\n      const { token: responseToken } = data.authGoogle;\r\n      login(responseToken);\r\n    } catch (error) {\r\n      throw error;\r\n    } finally {\r\n      setAuthLoading(false);\r\n      setAuthModal(false);;\r\n    }\r\n  }\r\n  return (\r\n    <header className={cn(s.header)}>\r\n      <Link className={s.logo} to='/'>\r\n        Открытые города\r\n      </Link>\r\n      <button type='button' className={s['nav__button']}>\r\n        <span />\r\n        <span />\r\n        <span />\r\n      </button>\r\n      <nav className={s.nav}>\r\n        <ul className={cn(s['nav__list'])}>\r\n          <li className={cn(s['nav__elem'])}>\r\n            <Link to='/about'>\r\n              О проекте\r\n            </Link>\r\n          </li>\r\n          <li className={cn(s['nav__elem'])}>\r\n            <Link to='/research'>\r\n              Исследования\r\n            </Link>\r\n          </li>\r\n          <li className={cn(s['nav__elem'], s['_dropdown'])}>\r\n            Города\r\n            <CitiesList />\r\n          </li>\r\n        </ul>\r\n        {\r\n          authLoading \r\n          ? <div className={s['nav__spiner']}><Spiner /></div>\r\n          : (token && user)\r\n            ? <Profile user={user} logout={logout}/>\r\n            : <Button onClick={openModalHandler}>Войти</Button> }\r\n        <Modal \r\n          isOpen={isAuthModalOpen}\r\n          onRequestClose={closeModalHandler}\r\n          shouldCloseOnOverlayClick={true}\r\n        >\r\n          <Modal.Title>Вход через социальные сети</Modal.Title>\r\n          { authLoading \r\n            ? <Spiner />\r\n            : (<>\r\n                <Modal.Body>\r\n                  Авторизуйтесь через следующие приложения:\r\n                </Modal.Body>\r\n                <GoogleButton onClick={googleSignHandler}>\r\n                  Google\r\n                </GoogleButton>\r\n              </>)\r\n            }\r\n        </Modal>\r\n      </nav>\r\n    </header>\r\n  );\r\n};","export const getRandomInt = (min: number, max: number) => {\r\n  return -(-(Math.random() * (max - min) + min)).toFixed(2);\r\n};\r\n\r\nexport const getRandomNormal = (\r\n  min: number,\r\n  max: number,\r\n  skew: number = 1\r\n): number => {\r\n  let u = 0;\r\n  let v = 0;\r\n  while (u === 0) u = Math.random(); // Converting [0,1) to (0,1)\r\n  while (v === 0) v = Math.random();\r\n  let num = Math.sqrt(-2.0 * Math.log(u)) * Math.cos(2.0 * Math.PI * v);\r\n\r\n  num = num / 10.0 + 0.5; // Translate to 0 -> 1\r\n  // if (num > 1 || num < 0) num = getRandomNormal(min, max, skew); // resample between 0 and 1 if out of range\r\n  num **= skew; // Skew\r\n  num *= max - min; // Stretch to fill range\r\n  num += min; // offset to min\r\n  return -(-num).toFixed(2);\r\n};\r\n","import React, { useState, useEffect } from 'react';\r\nimport { getRandomInt, getRandomNormal } from './utils';\r\nimport css from './MainBanner.module.sass';\r\n\r\nexport interface IDot {\r\n  duration: number;\r\n}\r\n\r\ninterface IDotProperies {\r\n  x: string;\r\n  y: string;\r\n  radius: number;\r\n}\r\n\r\nconst getRandomCircle = (): IDotProperies => {\r\n  const randomIntOrNormal = Math.random() > 0.33;\r\n  return {\r\n    x: `${randomIntOrNormal ? getRandomInt(0, 100) : getRandomNormal(10, 80)}%`,\r\n    y: `${randomIntOrNormal ? getRandomInt(0, 100) : getRandomNormal(35, 90)}%`,\r\n    radius: getRandomInt(8, 16)\r\n  };\r\n};\r\n\r\nconst DotCreate = ({ duration }: IDot) => {\r\n  const [{ x, y, radius }, setCircle] = useState(getRandomCircle());\r\n\r\n  useEffect(() => {\r\n    const interval = setInterval(() => {\r\n      setCircle(getRandomCircle());\r\n    }, duration * 1000);\r\n    return () => clearInterval(interval);\r\n  }, [duration]);\r\n\r\n  return (\r\n    <circle\r\n      className='innerCircle'\r\n      cx={x}\r\n      cy={y}\r\n      r='0'\r\n      fill='#38CDBE'\r\n      stroke='#38CDBE'\r\n      strokeWidth='3'\r\n    >\r\n      <animate\r\n        attributeType='SVG'\r\n        attributeName='r'\r\n        begin='0s'\r\n        dur={`${duration}s`}\r\n        repeatCount='indefinite'\r\n        from='0'\r\n        to={radius}\r\n      />\r\n      <animate\r\n        attributeType='CSS'\r\n        attributeName='stroke-width'\r\n        begin='0s'\r\n        dur={`${duration}s`}\r\n        repeatCount='indefinite'\r\n        from='5'\r\n        to='1'\r\n      />\r\n      <animate\r\n        attributeType='CSS'\r\n        attributeName='opacity'\r\n        begin='0s'\r\n        dur={`${duration}s`}\r\n        repeatCount='indefinite'\r\n        from='1'\r\n        to='0'\r\n      />\r\n    </circle>\r\n  );\r\n};\r\n\r\nexport const Banner = ({ dots }: any) => {\r\n  return (\r\n    <section className={css.banner}>\r\n      <div className={css.description}>\r\n        <h1 className={css.title}>\r\n          Сервис геоаналитики по&nbsp;открытым данным\r\n        </h1>\r\n        <p className={css.text}>\r\n          Более подробное описательное предложение о роде и виде занятий для\r\n          этого. И ниже призыв присоединиться к системе, все по шаблону\r\n        </p>\r\n      </div>\r\n      <div className={css.decorative}>\r\n        <svg\r\n          xmlns='http://www.w3.org/2000/svg'\r\n          viewBox='73.5 47.5 1888 904'\r\n          width={1888}\r\n          height={904}\r\n        >\r\n          <defs>\r\n            <clipPath id='a'>\r\n              <rect width={1888} height={904} x='73.5' y='47.5' />\r\n            </clipPath>\r\n          </defs>\r\n          <g\r\n            fill='none'\r\n            stroke='rgba(238, 238, 238, 0.5)'\r\n            strokeLinecap='square'\r\n            strokeMiterlimit='3'\r\n            clipPath='url(#a)'\r\n          >\r\n            <path\r\n              strokeWidth='3'\r\n              d='M817 218c-31.701-6.844-87.333-35.667-105-12-18 24.667-86.667 113.667-89 122-2.333 8.333-23.333 158-10 178 13.333 20 33.333 42 36 52 2.667 10 8.375 23.75 16 34s110.5 52.5 165 82c92.631 50.14 311 222.5 330 220s91.5-67 83-111c-8.186-42.373-23.434-86.147 23-123 31.5-25 47.969-59.008 30-81-33.5-41-50.667-152.667-36-170 14.667-17.333 15.333-36.333 11-60s-6.552-90.758-43-121c-36.448-30.242-113-36.5-138-54-18.18-12.726-59.474-34.474-78-53-22-22-90.333-79.333-119-5s-32 111.5-76 102zm334 673q10.547 6.313 29 59m-400 0q46-98 47-119c1-21 10-54 6-84s2-38-6-58-10-15.25-8-29 22.5-64.375 20-74c-5.204-20.036 2.75-22.25 12-20s83.333-73.667 87-79c3.667-5.333 21.906-111.531 20-115-1.906-3.469-28-11.25-37-18s150.25-101 163-112 22-23.25 30-43q8-19.75 60-150M75 777q112.5-.5 140-5c27.5-4.5 299-67.5 330-77q31-9.5 119-47 90.313-49.062 101-55c10.688-5.937 40.5-21.187 57-13q16.5 8.188 17 7m1121-234q-115.5 38-141 55c-25.5 17-91.5 57.5-112 62s-108 8.5-131 3-591.562-91.187-605-96q-13.437-4.812-14-6M843 216c7.5 3.75 13.125.5 24 7s28.625 20 28 29-5.375 63.25 0 68 24.625 9.625 27 16q2.375 6.375-1 17m433 597c-2.875-6.875-14.25-42.5-23-53q-8.75-10.5-57-75-33.625-36.422-48-42c-14.375-5.578-166.73-116.873-215-144-40.333-22.667-198.094-201.937-208-201-9.906.938-58.5 53.5-94 44s-170-9.5-200-33-123-115.333-147-129c-24-13.667-72.667-35.667-91-56s-82-95.25-196-93'\r\n              vectorEffect='non-scaling-stroke'\r\n            />\r\n            <path\r\n              strokeWidth='2'\r\n              d='M987 777q79.5-103.5 82-114c2.5-10.5 2.5-29-10-43S951.75 516 945 510s-27.875-33-73-39m-5 226l23-34q59 26 73 34t142 101l-31 43m-39-453q3.75 12.75 3 19c-.75 6.25-13 96.625-17 100s-77.375 72.875-81 82-17.509 30.488-19 33q-2.578 4.344-31 41m-32-176q12.25-12.125 14-16c1.75-3.875-6-51.5-5-56s1.625-8 8-15q6.375-7 46-47m9 385q64.667-97.333 75-107 10.333-9.667 33-32m-15-99q12.5 5.75 19 6c6.5.25 31.5 1.75 39 4s72.75-12.25 80-14q7.25-1.75 99-11m-191 175c9-1.5 11.5-10 20-4s87 72 97 77q10 5 48 5m-64-244c2 12.5 0 24 4 32s10.5 11.5 10 23 0 100.5-4 107q-4 6.5-35 46m37-54c12.375 10.5 11.5 15 17 15h64M896 378c8.5 9.375 9.75 11.25 11 18s-.625 20 2 22 17.5-11.125 26-10q8.5 1.125 18 3m241 0c-4.5-6-7-18.375-14-21s-17-.375-21-9-4-26.375-16-28-33.25 2.125-44-5-40.375-52.75-49-56q-8.625-3.25-32-7l-12 98m-35-7c4.375-6.625 1.75-12.25 10-19q8.25-6.75 30-18'\r\n              vectorEffect='non-scaling-stroke'\r\n            />\r\n            <path\r\n              d='M861 583l-22 4m40 92l91 62M858 563q16.625 93.563 19 95 2.375 1.438 13 5m215 135q11.75 10 14 9c2.25-1 20.5-25.75 19-28q-50-37.25-52-41c-2-3.75-17-22-21-20s-2.25 5-5 3q-2.75-2-19-15-10.312-6.625-13-8c-2.687-1.375-2.562 2.313-5 4-2.437 1.688-16.5-.937-22 0-5.5.938-33.312 41.25-34 44q-.687 2.75 29 17m31-65q-114.75-85.625-122-89c-7.25-3.375-69.062 19.016-75 16-5.937-3.016-58.5-17.5-61-23s2-7.75 0-11-68.667-78.667-66-86q2.667-7.333 4-53m149 238l-14-66m8 38l26-6m62-169q7.667-3 12 0c4.333 3 100.667 96.333 99 100q-1.667 3.667-11 12m-15-99q-25.062-7.953-31-5-5.937 2.953-20 13m10-7q-13.562-13.047-16-11-2.437 2.047-53 55m137 148L904 588l73-75m-73 75q-26.297-17.625-29-21c-2.703-3.375-8.672-14.062-13-18-4.328-3.937-71.5-63.25-76-69s-33.75-60.75-40-63-17.5-8.5-28-23-26-51.5-33-52-15 3-21 0q-6-3-26-38m122 132q-8.625 12.125-14 11c-5.375-1.125-10.625-3.75-17 0q-6.375 3.75-22 5-19.875-8.75-16-8c3.875.75-55.75-4-58-8s-.875-12.375-10-17q-9.125-4.625-255-99m693 402c-4.5 5.5-4.25 5.25-9 8s-9.5.75-17 17m15-241q.438 1.5 0 2-6.851 7.83-23 17l-31 33q-1.125.75-35 35m-93-116l56 56m-108-87l58-45m32-33l50 21m-37 25q-2.687-4.125-1-9 1.688-4.875 10-27m6-38l43 21m-16-39l20 35m-9-42l20 35M778 648q31.625-87.75 38-96t51-55l11-25m-44-9l-30 34m134 95q-88.5-89.5-94-89t-31 2m32-2l12-15m45-9q.667 15.333-4 21t-24 28m105 83l36-36 12-12m-16 63l-42-41m19-19q82.563 74.813 81 77-1.562 2.188-16 19m-249-84q-41.937-14.375-46-20c-4.062-5.625-23-23.333-23-30q0-6.667 3-51m-3 52l-10 9m-81 12q4.375-21.25 7-25c2.625-3.75 40.375-13.875 47-12q6.625 1.875 119 38m111 128l24-36'\r\n              vectorEffect='non-scaling-stroke'\r\n            />\r\n          </g>\r\n          {dots.map(({ duration }: IDot, i: number) => (\r\n            // eslint-disable-next-line react/no-array-index-key\r\n            <DotCreate key={`dot_${i}`} duration={duration} />\r\n          ))}\r\n        </svg>\r\n      </div>\r\n    </section>\r\n  );\r\n};\r\n","import React, { useState, useEffect } from 'react';\r\nimport { Helmet } from 'react-helmet';\r\nimport { getRandomInt } from '../widgets/MainBanner/utils';\r\nimport { Banner } from '../widgets/MainBanner';\r\n\r\n\r\nexport const MainPage = () => {\r\n  const [dots, setDots] = useState([{ duration: getRandomInt(4, 8), key: 0 }]);\r\n  const [activeDots, setActiveDots] = useState(0);\r\n\r\n  useEffect(() => {\r\n    const interval = setInterval(() => {\r\n      if (activeDots < 200) {\r\n        setDots([...dots, { duration: getRandomInt(3, 5), key: 0 }]);\r\n        setActiveDots(activeDots + 1);\r\n      }\r\n    }, 20);\r\n    return () => clearInterval(interval);\r\n  }, [dots, activeDots]);\r\n\r\n  return (\r\n    <>\r\n      <Helmet>\r\n        <title>Открытые города | Главная </title>\r\n      </Helmet>\r\n      <Banner dots={dots} />\r\n    </>\r\n  );\r\n};","import React, { useState } from 'react';\r\nimport css from './MapControllers.module.sass';\r\nimport { Modal } from '../../components/modal';\r\nimport { Formik, Field, Form, FormikActions } from 'formik';\r\nimport { useMutation, useQuery } from '@apollo/react-hooks';\r\nimport { CREATE_LAYER, GET_CITIES, GET_LAYERS } from '../../apollo';\r\n\r\ninterface Values {\r\n  name: string;\r\n  description: string;\r\n}\r\n\r\ninterface MapControllersProps {\r\n  defaultCity: string;\r\n}\r\n\r\ninterface CreateLayerProps {\r\n  city: string;\r\n}\r\n\r\nexport const CreateLayerModal = ({ city }: CreateLayerProps) => {\r\n  const [isCreateLayerModalOpen, setCreateLayerModalOpen] = useState(false);\r\n  const [createLayer, { data }] = useMutation(CREATE_LAYER);\r\n\r\n  const openModalHandler = () => {\r\n    setCreateLayerModalOpen(true);\r\n  }\r\n\r\n  const closeModalHandler = () => {\r\n    setCreateLayerModalOpen(false);\r\n  }\r\n\r\n  return(\r\n    <>\r\n      <button onClick={openModalHandler} className={css.add}>+</button>\r\n      <Modal \r\n        isOpen={isCreateLayerModalOpen}\r\n        onRequestClose={closeModalHandler}\r\n        shouldCloseOnOverlayClick={true}\r\n      >\r\n        <Formik\r\n      initialValues={{\r\n        name: '',\r\n        description: '',\r\n      }}\r\n      onSubmit={({ name, description}: Values, { setSubmitting }: FormikActions<Values>) => {\r\n        createLayer({\r\n          variables: {\r\n            name,\r\n            description,\r\n            city,\r\n          }\r\n        })\r\n        setSubmitting(false)\r\n      }}\r\n      render={() => (\r\n        <Form>\r\n          <label htmlFor=\"name\">Название слоя</label>\r\n          <Field id=\"name\" name=\"name\" placeholder=\"Ваше название\" type=\"text\" />\r\n\r\n          <label htmlFor=\"description\">Описание слоя</label>\r\n          <Field component='textarea' id=\"description\" name=\"description\" placeholder=\"Ваше описание\" type=\"text\" />\r\n\r\n          <button type=\"submit\" style={{ display: 'block' }}>\r\n            Отправить\r\n          </button>\r\n        </Form>\r\n      )}\r\n    />\r\n      </Modal>\r\n    </>\r\n  )\r\n}\r\n\r\n\r\nexport const MapControllers = ({ defaultCity }: MapControllersProps) => {\r\n  const { data: layersData, loading: layersLoading, error: layersError} = useQuery(GET_LAYERS, { variables: { city: defaultCity }});\r\n  \r\n  return(\r\n    <>\r\n      <CreateLayerModal city={defaultCity}/>\r\n    </>\r\n  )\r\n}","import React from 'react';\r\nimport { Helmet } from 'react-helmet';\r\nimport { Page } from '../components/layout';\r\nimport { Map, Marker, Popup, TileLayer } from 'react-leaflet';\r\nimport { MapControllers } from '../widgets/MapControllers';\r\n\r\ninterface MapProps {\r\n  city: string;\r\n  cityName: string;\r\n  center: [number, number];\r\n  zoom: number\r\n}\r\n\r\nexport const MapPage = ({ city, center, zoom, cityName }: MapProps) => {\r\n  return (\r\n    <>\r\n      <Helmet>\r\n        <title>Открытые города | {cityName} </title>\r\n      </Helmet>\r\n      <Page.Map>\r\n        <MapControllers defaultCity={city}/>\r\n        <Map center={center} zoom={zoom} style={{height: \"calc(100vh - 80px)\"}} >\r\n          <TileLayer\r\n            url=\"https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png\"\r\n            attribution=\"&copy; <a href=&quot;http://osm.org/copyright&quot;>OpenStreetMap</a> contributors\"\r\n          />\r\n          <Marker position={center}>\r\n            <Popup>A pretty CSS3 popup.<br />Easily customizable.</Popup>\r\n          </Marker>\r\n        </Map>\r\n      </Page.Map>\r\n    </>\r\n  )\r\n}","import React from 'react';\r\nimport { BrowserRouter, Switch, Route } from 'react-router-dom';\r\nimport { RouteChildrenProps } from 'react-router';\r\nimport { ApolloProvider } from '@apollo/react-hooks';\r\nimport { client } from './apollo';\r\nimport { Header } from './components/header';\r\n\r\nimport { AuthContext, useAuth } from './context';\r\nimport { MainPage, MapPage } from './pages';\r\n\r\nimport './static/styles/_main.sass';\r\n\r\ninterface MapMatchParams {\r\n  city: string;\r\n}\r\n\r\ninterface MapLocationState {\r\n  center: [number, number];\r\n  zoom: number;\r\n  name: string;\r\n}\r\n\r\nconst App: React.FC = () => {\r\n  const authContext = useAuth();\r\n  return (\r\n    <ApolloProvider client={client}>\r\n      <BrowserRouter>\r\n      <AuthContext.Provider value={authContext}>\r\n        <Header />\r\n        <main className='main-content'>\r\n          <Switch>\r\n            <Route exact path='/' component={MainPage} />\r\n            <Route path='/cities/:city' component={\r\n              (\r\n                { match, location: { state: { center, zoom, name } } }: RouteChildrenProps<MapMatchParams, MapLocationState>\r\n              ) => (\r\n                <MapPage city={match!.params.city} center={center} zoom={zoom} cityName={name}/>\r\n              )\r\n            } />\r\n          </Switch>\r\n        </main>\r\n      </AuthContext.Provider>\r\n      </BrowserRouter>\r\n    </ApolloProvider>\r\n    \r\n  );\r\n}\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\ntype Config = {\r\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\r\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\r\n};\r\n\r\nexport function register(config?: Config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(\r\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\r\n      window.location.href\r\n    );\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl: string, config?: Config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\nimport Modal from 'react-modal';\r\n\r\nModal.setAppElement('#root');\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"page_button__3jTi_\",\"_success\":\"page__success__3SUP6\",\"google-button\":\"page_google-button__2XlVT\",\"page__title\":\"page_page__title__122xz\",\"page__wrapper\":\"page_page__wrapper__866Hi\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"modal-wrapper\":\"modal_modal-wrapper__2Vyy5\",\"modal-window\":\"modal_modal-window__2GtFu\",\"modal-window__title\":\"modal_modal-window__title__31xJU\",\"modal-window__body\":\"modal_modal-window__body__1ZeM6\",\"modal-window__close\":\"modal_modal-window__close__1u9bC\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"banner\":\"MainBanner_banner__2_kFZ\",\"description\":\"MainBanner_description__1OoIM\",\"title\":\"MainBanner_title__26lqc\",\"text\":\"MainBanner_text__1Hc04\",\"decorative\":\"MainBanner_decorative__201zB\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"header_header__mSSfb\",\"_transparent\":\"header__transparent__QfXVf\",\"logo\":\"header_logo__1PP9h\",\"nav\":\"header_nav__2igZj\",\"nav__profile\":\"header_nav__profile__2hUaW\",\"nav__photo\":\"header_nav__photo__3vA1V\",\"nav__spiner\":\"header_nav__spiner__1f7db\",\"nav__button\":\"header_nav__button__3qVrU\",\"nav__list\":\"header_nav__list__P807k\",\"nav__elem\":\"header_nav__elem__3aKCs\",\"_dropdown\":\"header__dropdown__gd2SX\",\"nav__dropdown\":\"header_nav__dropdown__1RQI6\",\"_profile\":\"header__profile__K3eQQ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"spiner\":\"spiner_spiner__3eob9\",\"lds-ellipsis\":\"spiner_lds-ellipsis__1kWVz\",\"lds-ellipsis1\":\"spiner_lds-ellipsis1__1ED3Q\",\"lds-ellipsis2\":\"spiner_lds-ellipsis2__1zShh\",\"lds-ellipsis3\":\"spiner_lds-ellipsis3__2jpw2\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"add\":\"MapControllers_add__2wMKG\"};"],"sourceRoot":""}